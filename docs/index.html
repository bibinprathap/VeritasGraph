<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>The Four Stages of the VeritasGraph RAG Pipeline</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Inter', sans-serif;
            background-color: #f0f4f8;
        }
        .chart-container {
            position: relative;
            width: 100%;
            max-width: 500px;
            margin-left: auto;
            margin-right: auto;
            height: 300px;
            max-height: 400px;
        }
        @media (min-width: 768px) {
            .chart-container {
                height: 350px;
            }
        }
        .stage-card {
            background-color: white;
            border-radius: 0.5rem;
            box-shadow: 0 4px 6px -1px rgb(0 0 0 / 0.1), 0 2px 4px -2px rgb(0 0 0 / 0.1);
            border-top: 4px solid;
            transition: transform 0.3s ease-in-out, box-shadow 0.3s ease-in-out;
        }
        .stage-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 20px 25px -5px rgb(0 0 0 / 0.1), 0 8px 10px -6px rgb(0 0 0 / 0.1);
        }
        .flow-step {
            display: flex;
            align-items: center;
            padding: 0.75rem;
            background-color: #f9fafb;
            border-radius: 0.375rem;
            border: 1px solid #e5e7eb;
        }
        .flow-arrow {
            font-size: 1.5rem;
            color: #9ca3af;
            margin: 0.5rem 0;
        }
    </style>
</head>
<body class="text-gray-800">

    <div class="container mx-auto p-4 md:p-8">

        <header class="text-center mb-12">
            <h1 class="text-4xl md:text-5xl font-bold text-[#003f5c] mb-2">Deconstructing VeritasGraph</h1>
            <p class="text-xl md:text-2xl text-[#665191]">An In-Depth Look at the Four-Stage RAG Pipeline</p>
        </header>

        <div class="grid grid-cols-1 lg:grid-cols-2 gap-8">

            <div class="stage-card border-[#ffa600] p-6">
                <h2 class="text-2xl font-bold text-[#ffa600] mb-4">Stage 1: Knowledge Graph Construction</h2>
                <p class="mb-6 text-gray-600">This initial stage transforms raw, unstructured documents into a structured, interconnected knowledge graph. The goal is to create a rich data foundation that enables complex reasoning, moving beyond simple keyword or vector search.</p>
                <div class="flex flex-col items-center space-y-2">
                    <div class="flow-step w-full"><strong>Input:</strong> Unstructured Documents (.txt, .pdf)</div>
                    <div class="flow-arrow">▼</div>
                    <div class="flow-step w-full"><strong>Process:</strong> Document Chunking & LLM Extraction</div>
                    <div class="flow-arrow">▼</div>
                    <div class="flow-step w-full"><strong>Output:</strong> Assembled Knowledge Graph (Nodes & Edges)</div>
                </div>
                 <div class="mt-6">
                    <h3 class="text-lg font-semibold text-center mb-2 text-[#2f4b7c]">Graph Composition</h3>
                    <div class="chart-container h-64 md:h-72">
                        <canvas id="stage1Chart"></canvas>
                    </div>
                 </div>
            </div>

            <div class="stage-card border-[#ff7c43] p-6">
                <h2 class="text-2xl font-bold text-[#ff7c43] mb-4">Stage 2: Hybrid Retrieval</h2>
                <p class="mb-6 text-gray-600">Instead of relying on a single method, this stage uses a hybrid approach to find the most relevant information. It combines the broad reach of semantic search with the precision of graph traversal to uncover connections that would otherwise be missed.</p>
                <div class="flex flex-col items-center space-y-2">
                    <div class="flow-step w-full"><strong>Input:</strong> User Query</div>
                    <div class="flow-arrow">▼</div>
                    <div class="flow-step w-full"><strong>Process:</strong> Vector Search + Graph Traversal</div>
                    <div class="flow-arrow">▼</div>
                    <div class="flow-step w-full"><strong>Output:</strong> Pruned & Ranked Contextual Facts</div>
                </div>
                <div class="mt-6">
                    <h3 class="text-lg font-semibold text-center mb-2 text-[#2f4b7c]">Retrieval Effectiveness for Complex Queries</h3>
                     <div class="chart-container h-64 md:h-72">
                        <canvas id="stage2Chart"></canvas>
                    </div>
                </div>
            </div>

            <div class="stage-card border-[#f95d6a] p-6">
                <h2 class="text-2xl font-bold text-[#f95d6a] mb-4">Stage 3: LoRA-Tuned Reasoning</h2>
                <p class="mb-6 text-gray-600">Once the context is retrieved, a Large Language Model (LLM) synthesizes the final answer. The LLM is fine-tuned using Low-Rank Adaptation (LoRA), making it highly efficient and specialized for generating attributed, factual responses without requiring massive computational resources.</p>
                 <div class="mt-6">
                    <h3 class="text-lg font-semibold text-center mb-2 text-[#2f4b7c]">Model Enhancement via LoRA Tuning</h3>
                     <div class="chart-container h-64 md:h-72">
                        <canvas id="stage3Chart"></canvas>
                    </div>
                     <p class="text-center text-sm text-gray-500 mt-2">Comparison of a base model vs. a LoRA-tuned model on key performance metrics.</p>
                </div>
            </div>

            <div class="stage-card border-[#d45087] p-6">
                <h2 class="text-2xl font-bold text-[#d45087] mb-4">Stage 4: Attribution & Provenance</h2>
                <p class="mb-6 text-gray-600">The final and most critical stage ensures trust and transparency. Every claim in the generated answer is linked back to its source documents and the reasoning path taken through the graph. The output is a structured object containing the answer and its verifiable proof.</p>
                <div class="mt-6">
                    <h3 class="text-lg font-semibold text-center mb-2 text-[#2f4b7c]">Components of a Final Response</h3>
                    <div class="chart-container h-64 md:h-72">
                        <canvas id="stage4Chart"></canvas>
                    </div>
                    <p class="text-center text-sm text-gray-500 mt-2">The structured output ensures every piece of information is verifiable.</p>
                </div>
            </div>
        </div>

        <footer class="text-center text-gray-500 text-sm mt-12">
            <p>An infographic detailing the core components of the VeritasGraph enterprise RAG framework.</p>
        </footer>

    </div>

    <script>
        const brilliantBlues = ['#003f5c', '#665191', '#d45087', '#ff7c43', '#ffa600', '#2f4b7c', '#a05195', '#f95d6a'];

        const tooltipTitleCallback = {
            plugins: {
                tooltip: {
                    callbacks: {
                        title: function(tooltipItems) {
                            const item = tooltipItems[0];
                            let label = item.chart.data.labels[item.dataIndex];
                            if (Array.isArray(label)) {
                              return label.join(' ');
                            } else {
                              return label;
                            }
                        }
                    }
                }
            }
        };

        const stage1Ctx = document.getElementById('stage1Chart').getContext('2d');
        const stage1Chart = new Chart(stage1Ctx, {
            type: 'doughnut',
            data: {
                labels: ['Entities (e.g., People, Projects)', 'Relationships (e.g., "worked on")', 'Attributes (e.g., Dates)'],
                datasets: [{
                    data: [45, 35, 20],
                    backgroundColor: [brilliantBlues[4], brilliantBlues[3], brilliantBlues[5]],
                    hoverOffset: 4
                }]
            },
            options: {
                ...tooltipTitleCallback,
                maintainAspectRatio: false,
                plugins: {
                     ...tooltipTitleCallback.plugins,
                    legend: { display: false }
                }
            }
        });
        
        const stage2Ctx = document.getElementById('stage2Chart').getContext('2d');
        const stage2Chart = new Chart(stage2Ctx, {
            type: 'bar',
            data: {
                labels: ['Factual Accuracy', 'Context Relevance', 'Completeness'],
                datasets: [
                    {
                        label: 'Vector Search Only',
                        data: [65, 70, 55],
                        backgroundColor: brilliantBlues[5] + 'B3',
                        borderColor: brilliantBlues[5],
                        borderWidth: 1
                    },
                    {
                        label: 'VeritasGraph Hybrid Retrieval',
                        data: [92, 95, 88],
                        backgroundColor: brilliantBlues[3] + 'B3',
                        borderColor: brilliantBlues[3],
                        borderWidth: 1
                    }
                ]
            },
            options: {
                ...tooltipTitleCallback,
                maintainAspectRatio: false,
                scales: {
                    y: { beginAtZero: true, max: 100 }
                },
                plugins: {
                    ...tooltipTitleCallback.plugins,
                    legend: { position: 'bottom' }
                }
            }
        });

        const stage3Ctx = document.getElementById('stage3Chart').getContext('2d');
        const stage3Chart = new Chart(stage3Ctx, {
            type: 'radar',
            data: {
                labels: ['Reasoning', 'Attribution', 'Efficiency', 'Factual Accuracy', 'Conciseness'],
                datasets: [{
                    label: 'Base LLM',
                    data: [6, 4, 7, 7, 8],
                    fill: true,
                    backgroundColor: 'rgba(47, 75, 124, 0.2)',
                    borderColor: 'rgb(47, 75, 124)',
                    pointBackgroundColor: 'rgb(47, 75, 124)',
                }, {
                    label: 'LoRA-Tuned LLM',
                    data: [9, 9, 8, 9, 7],
                    fill: true,
                    backgroundColor: 'rgba(249, 93, 106, 0.2)',
                    borderColor: 'rgb(249, 93, 106)',
                    pointBackgroundColor: 'rgb(249, 93, 106)',
                }]
            },
            options: {
                ...tooltipTitleCallback,
                maintainAspectRatio: false,
                scales: {
                    r: {
                        beginAtZero: true,
                        max: 10,
                        ticks: { backdropColor: 'transparent' }
                    }
                },
                 plugins: {
                    ...tooltipTitleCallback.plugins,
                    legend: { position: 'bottom' }
                }
            }
        });
        
        const stage4Ctx = document.getElementById('stage4Chart').getContext('2d');
        const stage4Chart = new Chart(stage4Ctx, {
            type: 'polarArea',
            data: {
                labels: ['Synthesized Answer', 'Source Documents', 'Reasoning Path', 'Confidence Score'],
                datasets: [{
                    data: [40, 25, 25, 10],
                    backgroundColor: [
                        brilliantBlues[2],
                        brilliantBlues[1],
                        brilliantBlues[6],
                        brilliantBlues[0]
                    ]
                }]
            },
            options: {
                ...tooltipTitleCallback,
                maintainAspectRatio: false,
                scales: {
                    r: {
                        ticks: { display: false },
                        grid: { circular: true }
                    }
                },
                plugins: {
                    ...tooltipTitleCallback.plugins,
                    legend: { display: false }
                }
            }
        });
    </script>
</body>
</html>
